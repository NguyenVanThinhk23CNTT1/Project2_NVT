@model Project2_Nhom5.Areas.Admin.Models.BulkSeatCreateModel

@{
    ViewData["Title"] = "Thêm Ghế Hàng Loạt";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="mb-1">
            <i class="fas fa-layer-group me-2 text-primary"></i>Thêm Ghế Hàng Loạt
        </h2>
        <p class="text-muted mb-0">Tạo nhiều ghế cùng lúc cho rạp chiếu</p>
    </div>
    <a asp-action="Index" class="admin-btn-secondary">
        <i class="fas fa-arrow-left"></i>Quay lại
    </a>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card-dashboard">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-cogs me-2"></i>Cấu hình ghế hàng loạt
                </h5>
            </div>
            <div class="card-body">
                <form asp-action="BulkCreate" method="post" id="bulkCreateForm">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label asp-for="TheaterId" class="form-label">
                                    <i class="fas fa-building me-1"></i>@Html.DisplayNameFor(model => model.TheaterId)
                                </label>
                                <select asp-for="TheaterId" class="form-select" asp-items="ViewBag.TheaterId">
                                    <option value="">-- Chọn rạp chiếu --</option>
                                </select>
                                <span asp-validation-for="TheaterId" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label asp-for="SeatType" class="form-label">
                                    <i class="fas fa-tag me-1"></i>@Html.DisplayNameFor(model => model.SeatType)
                                </label>
                                <select asp-for="SeatType" class="form-select">
                                    <option value="thuong">Thường</option>
                                    <option value="vip">VIP</option>
                                </select>
                                <span asp-validation-for="SeatType" class="text-danger"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label asp-for="StartRow" class="form-label">
                                    <i class="fas fa-sort-numeric-up me-1"></i>@Html.DisplayNameFor(model => model.StartRow)
                                </label>
                                <input asp-for="StartRow" class="form-control" type="number" min="1" max="26" />
                                <small class="form-text text-muted">1 = A, 2 = B, ..., 26 = Z</small>
                                <span asp-validation-for="StartRow" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label asp-for="EndRow" class="form-label">
                                    <i class="fas fa-sort-numeric-down me-1"></i>@Html.DisplayNameFor(model => model.EndRow)
                                </label>
                                <input asp-for="EndRow" class="form-control" type="number" min="1" max="26" />
                                <small class="form-text text-muted">1 = A, 2 = B, ..., 26 = Z</small>
                                <span asp-validation-for="EndRow" class="text-danger"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label asp-for="StartColumn" class="form-label">
                                    <i class="fas fa-sort-numeric-up me-1"></i>@Html.DisplayNameFor(model => model.StartColumn)
                                </label>
                                <input asp-for="StartColumn" class="form-control" type="number" min="1" max="50" />
                                <span asp-validation-for="StartColumn" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label asp-for="EndColumn" class="form-label">
                                    <i class="fas fa-sort-numeric-down me-1"></i>@Html.DisplayNameFor(model => model.EndColumn)
                                </label>
                                <input asp-for="EndColumn" class="form-control" type="number" min="1" max="50" />
                                <span asp-validation-for="EndColumn" class="text-danger"></span>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form-check">
                            <input asp-for="SkipExisting" class="form-check-input" type="checkbox" />
                            <label asp-for="SkipExisting" class="form-check-label">
                                <i class="fas fa-check-circle me-1"></i>@Html.DisplayNameFor(model => model.SkipExisting)
                            </label>
                        </div>
                        <small class="form-text text-muted">Nếu bỏ chọn, quá trình sẽ dừng lại khi gặp ghế đã tồn tại</small>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="admin-btn-primary">
                            <i class="fas fa-plus"></i>Tạo ghế hàng loạt
                        </button>
                        <button type="button" class="admin-btn-secondary" onclick="previewSeats()">
                            <i class="fas fa-eye"></i>Xem trước
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card-dashboard">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Thông tin
                </h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <h6><i class="fas fa-lightbulb me-2"></i>Hướng dẫn sử dụng:</h6>
                    <ul class="mb-0">
                        <li><strong>Hàng:</strong> Sử dụng số 1-26 tương ứng với A-Z</li>
                        <li><strong>Cột:</strong> Sử dụng số 1-50</li>
                        <li><strong>Mã ghế:</strong> Tự động tạo theo format A01, A02, B01, B02...</li>
                        <li><strong>Bỏ qua ghế đã tồn tại:</strong> Chỉ tạo ghế mới, bỏ qua ghế đã có</li>
                    </ul>
                </div>

                <div class="alert alert-warning">
                    <h6><i class="fas fa-exclamation-triangle me-2"></i>Lưu ý:</h6>
                    <ul class="mb-0">
                        <li>Tối đa có thể tạo <strong>1,300 ghế</strong> (26 hàng × 50 cột)</li>
                        <li>Quá trình tạo có thể mất vài giây với số lượng lớn</li>
                        <li>Không thể hoàn tác sau khi tạo thành công</li>
                    </ul>
                </div>

                <div id="previewSection" style="display: none;">
                    <h6><i class="fas fa-table me-2"></i>Xem trước:</h6>
                    <div id="previewContent" class="border rounded p-2 bg-light">
                        <!-- Preview content will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        function previewSeats() {
            const startRow = parseInt(document.getElementById('StartRow').value) || 1;
            const endRow = parseInt(document.getElementById('EndRow').value) || 10;
            const startColumn = parseInt(document.getElementById('StartColumn').value) || 1;
            const endColumn = parseInt(document.getElementById('EndColumn').value) || 15;

            if (startRow > endRow || startColumn > endColumn) {
                alert('Vui lòng kiểm tra lại phạm vi hàng và cột!');
                return;
            }

            let previewHtml = '<div class="text-center mb-2"><strong>Mã ghế sẽ được tạo:</strong></div>';
            previewHtml += '<div class="text-center mb-2">';
            
            for (let row = startRow; row <= endRow; row++) {
                const rowLetter = String.fromCharCode(64 + row); // A=65, B=66, etc.
                previewHtml += `<div class="mb-1">`;
                
                for (let col = startColumn; col <= endColumn; col++) {
                    const seatCode = `${rowLetter}${col.toString().padStart(2, '0')}`;
                    previewHtml += `<span class="badge bg-primary me-1 mb-1">${seatCode}</span>`;
                }
                
                previewHtml += `</div>`;
            }
            
            previewHtml += '</div>';
            previewHtml += `<div class="text-center"><small class="text-muted">Tổng cộng: ${(endRow - startRow + 1) * (endColumn - startColumn + 1)} ghế</small></div>`;

            document.getElementById('previewContent').innerHTML = previewHtml;
            document.getElementById('previewSection').style.display = 'block';
        }

        // Auto-update preview when form values change
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = ['StartRow', 'EndRow', 'StartColumn', 'EndColumn'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    if (document.getElementById('previewSection').style.display !== 'none') {
                        previewSeats();
                    }
                });
            });
        });
    </script>
} 